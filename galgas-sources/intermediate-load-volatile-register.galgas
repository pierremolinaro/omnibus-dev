
setter @instructionListIR appendLoadVolatileRegister
  ?let @operandIR inTargetValue
  ?let @string inRegisterName
  ?let @bigint inAddress
{
  self += !@loadRegisterIR.new {!inTargetValue !inRegisterName !inAddress}
}

#———————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

class @loadRegisterIR : @abstractInstructionIR {
  @operandIR mTargetValue
  @string mRegisterName
  @bigint mRegisterAddress
}

#———————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

override method @loadRegisterIR llvmInstructionCode
  ?!@string ioLLVMcode
  ?let @generationContext unused inGenerationContext
  ?!@generationAdds unused ioGenerationAdds
{
  let llvmType = [mTargetValue.mType llvmTypeName]
  ioLLVMcode += "  " + mTargetValue.mValue + " = load volatile " + llvmType + ", " + llvmType
         + "* inttoptr (i32 " + mRegisterAddress + " to " + llvmType + "*) ; " + [mRegisterAddress hexString] + "\n"
}

#———————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

override method @loadRegisterIR enterAccessibleEntities ?!@accessibleEntities ioAccessibleEntities {
  ioAccessibleEntities.mAccessibleRegisterSet += !mRegisterName
}

#———————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
