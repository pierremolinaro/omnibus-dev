#———————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
#                                                                                                                       
#    I N T E R M E D I A T E    C O D E    G E N E R A T I O N                                                          
#                                                                                                                       
#———————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

struct @intermediateCodeStruct {
  @staticEntityMap mStaticEntityMap
  @globalConstantMapIR mGlobalConstantMap
  @interruptMapIR mInterruptMapIR
  @externProcedureMapIR mExternProcedureMapIR
  @stringset mRequiredProcedureSet
  @instructionListSortedListIR mPanicSetupInstructionListIR
  @instructionListSortedListIR mPanicLoopInstructionListIR
  @taskMapIR mTaskMapIR
  @globalTaskVariableList mGlobalTaskVariableList
  @uint mMaxBranchOfOnInstructions
  @targetParameters mTargetParameters
  @driverListIR mDriverList
  @staticListInvokedFunctionSetMap mStaticArrayMapForIntermediate
  @generationListIR mGenerationListIR
  @globalSyncInstanceMapIR mGlobalSyncInstanceMap
  @controlRegisterGroupArrayList mControlRegisterGroupArrayList
#--- Routines
  @guardMapIR mGuardListIR
  @routineListIR mRoutineListIR
}

#———————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

list @controlRegisterGroupArrayList {
  @lstring mGroupName
  @lbigintlist mBaseAddresses
}

#———————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

map @globalConstantMapIR {
  @unifiedTypeMap-proxy mType
  @objectIR mSourceExpression
  insert insertKey error message "** internal error **"
  search searchKey error message "** internal error **"
}

#———————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

abstract class @abstractRoutineIR {
  @lstring mRoutineMangledName
  @bool mIsRequired
  @bool mWarnIfUnused
}

#·······················································································································

abstract method @abstractRoutineIR svcDeclarationGeneration
  ?!@primitiveAndServiceIRlist ioPrimitiveAndServiceList
  ?!@sectionIRlist ioSectionList
  ?!@generationAdds ioGenerationAdds

#·······················································································································

abstract method @abstractRoutineIR llvmCodeGeneration 
  ?!@string ioLLVMcode
  ?!@string unused ioAssemblerCode
  ?let @generationContext inGenerationContext
  ?!@generationAdds ioGenerationAdds

#·······················································································································

abstract method @abstractRoutineIR enterAccessibleEntities
   ?!@stringset ioInvokedRoutineSet
   ?!@uint ioMaxBranchOfOnInstructions

#———————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

list @routineListIR {
  @abstractRoutineIR mRoutine
}

#———————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
