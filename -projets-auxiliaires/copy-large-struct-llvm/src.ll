;------------------------------------------------------------------
;    Target specific code                                                                                              *
;------------------------------------------------------------------

;--- For LLVM < 9.0.0
;target datalayout = "e-m:e-p:32:32-i64:64-v128:64:128-a:0:32-n32-S64"

;--- For LLVM >= 9.0.0
target datalayout = "e-m:e-p:32:32-Fi8-i64:64-v128:64:128-a:0:32-n32-S64"

;---
target triple = "thumbv7em-none--eabi"


;------------------------------------------------------------------
;    User Defined Types                                                                                                *
;------------------------------------------------------------------

;%U = type [1000 x i32]
%U = type i1024


;------------------------------------------------------------------
;    Sample code
;------------------------------------------------------------------

define void @myCopyRef (%U* %target, %U* %source) {
  %temp = alloca %U
  %u = load %U, %U* %source
  store %U %u, %U* %temp
  %v = load %U, %U* %temp
  store %U %v, %U* %target
  ret void
}

;------------------------------------------------------------------

define void @myCopyVal (%U* %target, %U %source) {
  store %U %source, %U* %target
  ret void
}

;------------------------------------------------------------------

define %U @myAddRef (%U* %op1, %U* %op2) {
  %x1 = load %U, %U* %op1
  %x2 = load %U, %U* %op2
  %r = add %U %x1, %x2
  ret %U %r
}

;------------------------------------------------------------------

define %U @myAddVal (%U %op1, %U %op2) {
  %r = add %U %op1, %op2
  ret %U %r
}

;------------------------------------------------------------------

define void @myAssignment (%U* %target) {
  store %U 123456789012345667890123456789012345678901234566789012345678901234567890123456678901234567890, %U* %target
  ret void
}

;------------------------------------------------------------------
