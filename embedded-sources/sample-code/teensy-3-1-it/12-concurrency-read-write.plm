target "teensy-3-1-it"

//------------------------------------------------*

var gValue1 $uint32 = 0 {
  @rw proc loop
  @rw proc userSystickHandler
}

//------------------------------------------------*

var gValue2 $uint32 = 0 {
  @rw proc loop
  @rw proc userSystickHandler
}

//------------------------------------------------*

var gIsCounting $bool = true {
  @rw proc loop
  proc userSystickHandler
}

//------------------------------------------------*

proc userSystickHandler `isr () {
  if gIsCounting then
    gValue1 +%= 1
    gValue2 +%= 1
  end
}

//------------------------------------------------*

func maFonction `user (?a:a $uint27 ?b $uint27) -> $uint27 {
  result = a +% b
}

//------------------------------------------------*

proc setup `user () {
}

//------------------------------------------------*

proc loop `user () {
  gValue1 +%= 1
  gValue2 +%= 1
  let y $uint27 = 123
  let x = maFonction (!a:y !456)
  if gIsCounting and (millis () > 5_000) then
    gIsCounting = false
    printUnsigned (!gValue1)
    goto (!line:1 !column:0)
    printUnsigned (!gValue2)
  end
}

//------------------------------------------------*
