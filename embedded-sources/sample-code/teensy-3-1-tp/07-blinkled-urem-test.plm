target "teensy-3-1-tp"

//------------------------------------------------*

task T priority 12 stackSize 512 {
  var toggle $bool = true
  var gCount $uint32 = 0

  proc setup {
  }
  
  proc loop {
    waitDuringMS (!delay:250)
    ledOn (!LED_L1) // Allumer la led
    waitDuringMS (!delay:250)
    ledOff (!LED_L1)  // Ã‰teindre la led
    toggle = not toggle
    if toggle then
      gCount += 1
      goto (!line:1 !column:0)
      printUnsigned (!gCount)
      goto (!line:2 !column:0)
      printUnsignedUsingMod (!gCount)
    end
  }
}

proc printUnsignedUsingMod `user @noWarningIfUnused (?inValue $uint32) {
  var divisor $uint32 = 1_000_000_000
  var value = inValue
  var isPrinting = false
  while divisor > 0 do
    if isPrinting or (value >= divisor) then
      let quotient = value / divisor
      writeData_inUserMode (!0x30 + convert quotient : $uint8)
    //  value = value - quotient * divisor
      value = value % divisor
      isPrinting = true
    end
    divisor = divisor / 10
  end
  if not isPrinting then
    writeData_inUserMode (!0x30)
  end
}

//------------------------------------------------*
