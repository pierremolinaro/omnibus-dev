target "teensy-3-1-tp"

//------------------------------------------------*

var gValue1 $uint32 = 0 {
  @rw proc loop
  @rw proc userSystickHandler
}

//------------------------------------------------*

var gValue2 $uint32 = 0 {
  @rw proc loop
  @rw proc userSystickHandler
}

//------------------------------------------------*

var gIsCounting $bool = true {
  @rw proc loop
  proc userSystickHandler
}

//------------------------------------------------*

proc userSystickHandler `isr () {
  if gIsCounting then
    gValue1 +%= 1
    gValue2 +%= 1
  end
}

//------------------------------------------------*

task T priority 12 stackSize 512 {

  proc setup {
  }
  proc loop  {
    gValue1 +%= 1
    gValue2 +%= 1
    if gIsCounting and (millis () > 5_000) then
      gIsCounting = false
      printUnsigned (!gValue1)
      goto (!line:1 !column:0)
      printUnsigned (!gValue2)
    end
  }
}

//------------------------------------------------*
