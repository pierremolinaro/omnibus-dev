target "target-teensy-sequential-systick.plms"


//-----------------------------------------------------------------------------*

proc $user setup () {
}

//-----------------------------------------------------------------------------*

var $isr gClignotement : UInt32 = 0

//-----------------------------------------------------------------------------*

proc $isr userSystickHandler () {
  gClignotement ++
  if gClignotement == 500 then
    GPIOA_PSOR = 1 << 12 ;
  elsif gClignotement == 1000 then
    GPIOA_PCOR = 1 << 12 ;
    gClignotement = 0
  end
}

//-----------------------------------------------------------------------------*

var $user gVar : Int8 = 0

//-----------------------------------------------------------------------------*

proc $user loop () {
  let duration : UInt32 = 100
  waitMS (!duration)
  ledOn (!LED_TEENSY)
  waitMS (!duration)
  ledOff (!LED_TEENSY)
  gVar ++ // Engendre une exception
  goto (!line:0 !column: 0)
  printSpaces (!4)
  goto (!line:0 !column: 0)
  printSigned (!gVar as Int32)
}

//-----------------------------------------------------------------------------*
