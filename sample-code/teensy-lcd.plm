target "target-teensy-sequential-systick.plms"

//-----------------------------------------------------------------------------*

proc $user setup () {
}

//-----------------------------------------------------------------------------*

var $isr gClignotement : UInt32 = 0

//-----------------------------------------------------------------------------*

proc $isr userSystickHandler () {
  gClignotement ++
  if gClignotement == 500 then
    ledOn (!LED_L0) ;
  elsif gClignotement == 1000 then
    gClignotement = 0
    ledOff (!LED_L0) ;
  end
}

//-----------------------------------------------------------------------------*

var $user gVar : Int8 = 0

var $user gZZZZ : UInt8 = 0
var $user gYYYYY : UInt32 = 0

//-----------------------------------------------------------------------------*

proc $user loop () {
  waitMS (!100)
  ledOn (!LED_TEENSY)
  waitMS (!100)
  ledOff (!LED_TEENSY)
  gVar ++ // Engendre une exception
  goto (!line:0 !column: 0)
  printSpaces (!4)
  goto (!line:0 !column: 0)
  printSigned (!gVar as Int32)
  gYYYYY = ICSR::VECTPENDING (gZZZZ)
}

//-----------------------------------------------------------------------------*
